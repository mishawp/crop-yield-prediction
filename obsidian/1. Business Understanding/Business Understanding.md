## 1. Обзор проекта

### 1.1. Бизнес цель проекта

Создание интеллектуальной системы прогнозирования урожайности сельскохозяйственных культур для повышения эффективности агропроизводства и принятия управленческих решений.

### 1.2. Постановка задачи

Разработка модели машинного обучения, способной прогнозировать урожайность сельскохозяйственных культур на основе анализа спутниковых изображений, метеорологических данных и исторических данных об урожайности. 

### 1.3. Обоснование проекта 

Система позволит аграрным компаниям, холдингам и государственным структурам:
- **Сократить убытки**, связанные с неэффективным планированием сельхозработ и изменениями погодных условий;
- **Оптимизировать ресурсы** (семена, удобрения, техника) за счёт точного прогнозирования урожайности;
- **Обеспечить продовольственную безопасность** и устойчивость сельского хозяйства в условиях климатических изменений, особенно в регионах России с высокими рисками;
- **Снижать финансовые риски** для фермеров и агропредприятий.

### 1.4. Существующие решения

**Существующие решения:**
- **Cropio:** Система дистанционного контроля сельскохозяйственных угодий, позволяющая осуществлять мониторинг состояния посевных площадей, прогнозирование и планирование сельскохозяйственных операций.

**Преимущества предлагаемого проекта:**
- **Масштабируемость:** Возможность адаптации модели для различных регионов и культур.
- **Использование открытых данных:** Применение общедоступных данных снижает затраты на сбор информации.
- **Обучающий характер проекта:** Разработка модели в рамках учебного проекта позволяет студенту получить практический опыт в области анализа данных и машинного обучения.


## 2. Текущая ситуация

### 2.1. Доступные данные

- **Спутниковые изображения** Sentinel-2, рассчитанные в индексах AG (Active Greenness) и NDVI (Normalized Difference Vegetation Index), за период 2017–2022 гг. для территории США.
- **Данные об урожайности** сельскохозяйственных культур от USDA.
- **Метеорологические данные** по территории США, полученные из модели WRF-HRRR.
- **Дополнительные данные**, в зависимости от результатов модели. Например, SoilGrids, и т.д.

### 2.2. Вычислительные ресурсы

- **Размер данных** от 200 гб до 2 ТБ. Необходимо *облачное хранилище*.
- **Вычислительная мощность** точно не известна, но обучаться будут глубокие нейронные сети. Необходимы *облачные вычислительные ресурсы*

### 2.3. Риски и ограничения

- **Качество данных:** возможны пропуски в данных, наличие облачности на спутниковых изображениях.
- **Объем данных:** большой объем данных может потребовать значительных вычислительных ресурсов и времени на обработку.
- **Обобщаемость модели:** модель, обученная на данных США, может не показывать аналогичную точность при применении в других регионах без дополнительной адаптации.
- **Ограниченные ресурсы:** проект выполняется одним студентом, что может ограничить скорость разработки и внедрения.


## 3. Анализ целей

### 3.2. Метрики оценки качества модели

- **RMSE (корень из средней квадратичной ошибки).**
- **R² (коэффициент детерминации).**
- **Quantile Loss (квантильная функция потерь)** или другая асимметричная метрика: если захотим больше штрафовать за перепрогноз, нежели за недопрогноз.

### 3.3. Критерии успешности

- **Минимальный порог:** R² ≥ 0.60 за 3 месяца до сбора урожая.
- **Оптимальный результат:** R² ≥ 0.70 и RMSE ≤ 20% от средней урожайности за 3 месяца до сбора. \[[1](https://www.mdpi.com/2073-4395/14/10/2262?utm_source=chatgpt.com), [2](https://link.springer.com/article/10.1007/s40808-024-02188-9?utm_source=chatgpt.com)\]


## 4. План проекта

### 4.1. Анализ данных (Data Understanding)

- **Сбор и предварительная обработка** спутниковых изображений, метеорологических данных и данных об урожайности.
- **Исследовательский анализ данных:** выявление пропущенных значений, оценка распределения данных, анализ корреляций между переменными.

### 4.2. Подготовка данных (Data Preparation)

- **Обработка спутниковых изображений:** удаление облачных участков, нормализация данных, извлечение вегетационных индексов.
- **Интеграция данных:** объединение спутниковых, метеорологических и агрономических данных в единую структуру.
- **Формирование признаков:** создание временных рядов, агрегация данных по регионам и культурам.

### 4.3. Моделирование (Modeling)

- **Выбор моделей** машинного обучения:
  - **Линейные модели:** MLR, LASSO.
  - **Деревья решений:** Random Forest, XGBoost.
  - **Глубокое обучение:** CNN, RNN, GNN-RNN.
  - **Мультимодальные модели:** CNN + RNN, GNN + Attention, early fusion, late fusion
- **Обучение и валидация моделей**: разделение данных на обучающую и тестовую выборки, кросс-валидация, настройка гиперпараметров.

### 4.4. Оценка результата (Evaluation)

- **Сравнение** результатов прогнозирования модели с реальными значениями урожайностью.

### 4.5. Внедрение (Deployment)

- **Внедрение системы** в бизнес процессы.
- **Подготовка документации** по использованию системы.
- **Мониторинг** качества модели
